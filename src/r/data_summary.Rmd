---
title: "Immune cell data summary"
author: "Scott Campit"
output: 
  html_notebook:
    toc: yes
    theme: united
---

# Summary
**This analysis contains 3 time points:**

  1. *Day 7*:  Pre-metastatic niche - tumor cells have not arrived
  2. *Day 14*: Metastatic niche - tumor cells arrived but no proliferation
  3. *Day 21*: Metabstatic niche - secondary tumors in lung 

**The driving questions are the following:**

  1. Do neutrophils adopt an immunosuppressive or immunoevasive phenotype driven by rewired metabolism?
  2. How do other immune cell types, such as NK cell and T-cell, change their metabolic pathways to facilitate immunosuppression and evasion?
  3. Can we infer a regulatory relationship between neutrophil and T-cells via altered metabolic processes?

# 1. Load libraries and data
First, we'll load the libraries and dataset we'll need to analyze the data.

```{r}
# Load the libraries
#install.packages(c("mgcv", "splines", "Seurat", "tidyverse", 
#                   "viridis", "matrixStats", "UpSetR", 
#                   "reshape2", "ggplot2", "phateR"))
library(mgcv)
library(splines)
library(Seurat)
library(tidyverse)
library(viridis)
library(matrixStats)
library(UpSetR)
library(reshape2)
library(ggplot2)
library(phateR)
library(reticulate)

# Load the data
# Dell
#load("D:/Data/scRNASeq/shea/lung.robj", verbose=TRUE)

# ACLX
load("C:/Users/scott/Data/scRNASeq/shea/lung.robj", verbose=TRUE)

# Linux
#load("~/Data/scRNASeq/shea/lung.Robj")
#unique(neutrophils@meta.data[["CellType"]])
```

# 2. Get a summary of counts for each cell type in data set.

First, let's get the gene names
```{r}
lung_data = GetAssayData(lung, assay="RNA", slot='data')
gene_symbol = lung_data@Dimnames[[1]]
```

## 2a. Get count matrix
The code block below is for summarizing the dataset. Specifically, the for loop below counts the number of cells belonging to each cell type and time point. 
```{r}
# Creating the count matrix
cnt_mat = matrix(, nrow=13, ncol=4)
for(i in 1:length(celltype.list)){
  cnt_mat[i, 1] = sum(celltype.list[[i]]@meta.data$Time == 0)
  cnt_mat[i, 2] = sum(celltype.list[[i]]@meta.data$Time == 7)
  cnt_mat[i, 3] = sum(celltype.list[[i]]@meta.data$Time == 14)
  cnt_mat[i, 4] = sum(celltype.list[[i]]@meta.data$Time == 21)
}
```
