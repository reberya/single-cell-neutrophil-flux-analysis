---
title: "Convert Seurat to Python Object"
author: "Scott Campit"
output: 
  html_notebook:
    toc: yes
    theme: united
---

# Summary
I'm trying to use `phateR`, but keep on running into errors when transforming the data. So, I want to see if the Python package for PHATE is more developed than the R package. To do that, I need to convert the Seurat object to .h5ad.

```{r}
rm(list=ls())
library(Seurat)
library(scater)
library(tidyverse)

#install.packages("devtools")
#devtools::install_github(repo="hhoeflin/hdf5r")
#devtools::install_github(repo="mojaveazure/loomR", 
#                         ref="develop")
library(loomR)
```

# 1. Save Entire Data As loom File
```{r}
# Load Seurat object as is
load("C:/Users/scott/Data/scRNASeq/shea/lung.robj", verbose=TRUE)
lung.loom = Seurat::as.loom(lung,filename="C:/Users/scott/Data/scRNASeq/shea/lung.loom")
```

# 2. Save Entire Dataset as .csv Files
Now we'll save the count data, the gene symbols, and the cell type as several csv files.
```{r}
load("C:/Users/scott/Data/scRNASeq/shea/lung.robj", verbose=TRUE)

# Count data
data = lung@assays$RNA@counts
data = as.data.frame(data)
write_delim(data, 
            "C:/Users/scott/Data/scRNASeq/shea/lung.csv",
            delim=',')

# Gene Symbol Data
MGI.Symbol = as.data.frame(rownames(data))
write_delim(MGI.Symbol, 
            "C:/Users/scott/Data/scRNASeq/shea/symbol.csv",
            delim=",")

# Cell identification data
active_indent = as.data.frame(lung@active.ident)
active_indent$true_ident = rownames(active_indent)
rownames(active_indent) = NULL
write_delim(x=active_indent,
            file="C:/Users/scott/Data/scRNASeq/shea/active_ident.csv",
            delim=',')
```
# 3. Save Subsets as Separate .csv Files
To perform data imputation and to save on memory, let's separate the data.